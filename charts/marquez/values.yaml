image:
  api: "ilum/marquez:0.53.0"
  web: "ilum/marquez-web:0.53.0"
  opensearch: "opensearchproject/opensearch:2.5.0"

replicaCount: 1

postgres:
  host: postgis1-rw
  port: 5432
  database: marquez
  user: marquez
  existingSecret: marquez-db-secret
  existingSecretKey: password

search:
  enabled: false
  host: opensearch
  port: 9200

service:
  api:
    port: 5000
  web:
    port: 5002

ingress:
  enabled: true
  className: nginx
  host: marquez.celine.local
  tlsEnabled: true
  tlsSecret: marquez-tls
  annotations:
    cert-manager.io/issuer: letsencrypt-prod
    # nginx.ingress.kubernetes.io/rewrite-target: /
    nginx.ingress.kubernetes.io/auth-url: "https://sso.celine.local/oauth2/auth"
    nginx.ingress.kubernetes.io/auth-signin: "https://sso.celine.local/oauth2/start?rd=$scheme://$host$request_uri"
    nginx.ingress.kubernetes.io/auth-response-headers: "Authorization, X-Auth-Request-Email, X-Auth-Request-User"

persistence:
  enabled: false
  size: 5Gi
  storageClass: ""

resources:
  api:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 2000m
      memory: 2Gi
  web:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi

# JVM tuning passed as env var to the api container.
# Heap: 512m initial / 1.5g max â€” leaves ~512Mi headroom for off-heap (Netty, etc.)
# G1GC is better than default ParallelGC for latency-sensitive workloads.
# MaxGCPauseMillis=200 targets <200ms GC pauses.
javaOpts: "-Xms512m -Xmx1536m -XX:+UseG1GC -XX:MaxGCPauseMillis=200 -XX:+ExitOnOutOfMemoryError"
