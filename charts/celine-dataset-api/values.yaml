## ----------------------------------------------------------------------------
## celine-dataset-api â€” values.yaml
## ----------------------------------------------------------------------------

fullnameOverride: dataset-api

image:
  repository: ghcr.io/celine-eu/dataset-api
  tag: "latest"
  pullPolicy: IfNotPresent

replicaCount: 1

service:
  type: ClusterIP
  port: 8001

ingress:
  enabled: false
  domain: celine.local
  host: "dataset-api.celine.local"
  issuer: celine-tls
  auth:
    enabled: true
  tls:
    enabled: true
    secretName: ""
  annotations: {}

oidc:
  baseUrl: "http://keycloak/realms/celine"
  jwksUri: "http://keycloak/realms/celine/protocol/openid-connect/certs"
  allowedAudiences: ""
  includeClientIdAsAudience: true
  timeout: 10.0
  service:
    clientId: "svc-dataset-api"
    audience: "svc-dataset-api"
    clientSecret: "svc-dataset-api" # [secret]

policies:
  dir: "/app/policies"
  dataDir: ""
  cacheEnabled: true
  cacheTtl: 300
  cacheMaxsize: 10000

postgres:
  existingSecret: "postgis1-datasets-readonly-connection-string"
  dsnEnvVar: "DATABASE_URL"
  secretKey: "connection-string"

s3:
  endpointUrl: ""
  region: "us-east-1"
  existingSecret: "s3-account-user-rw"

migrate:
  enabled: false
  command: ["alembic", "upgrade", "head"]
  extraEnv: []

healthCheck:
  enabled: true
  path: /health
  initialDelaySeconds: 10
  periodSeconds: 30
  failureThreshold: 3

configMap:
  enabled: false
  name: ""
  mountPath: /app/config
  data: {}

volumeMounts: []
volumes: []

logLevel: "INFO"
extraEnv: []
extraSecrets: {}

podAnnotations: {}
podSecurityContext:
  runAsUser: 1000
resources: {}
nodeSelector: {}
tolerations: []
affinity: {}
